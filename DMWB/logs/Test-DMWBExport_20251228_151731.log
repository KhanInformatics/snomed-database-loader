[2025-12-28 15:17:31] [INFO] ========================================================
[2025-12-28 15:17:31] [INFO] DMWB Export Validation Test Suite
[2025-12-28 15:17:31] [INFO] ========================================================
[2025-12-28 15:17:31] [INFO] SQL Server: localhost\SQLEXPRESS
[2025-12-28 15:17:31] [INFO] Database: DMWB_Export
[2025-12-28 15:17:31] [INFO] Source: C:\DMWB\CurrentReleases
[2025-12-28 15:17:31] [INFO] 
[2025-12-28 15:17:31] [INFO] Found 9 Access database files
[2025-12-28 15:17:31] [INFO] 
[2025-12-28 15:17:31] [INFO] 
Testing overall table counts...
[2025-12-28 15:17:31] [PASS]   ✓ Database has 46 tables
[2025-12-28 15:17:31] [INFO] Testing: DMWB NHS Data Migration Maps.mdb
[2025-12-28 15:17:32] [PASS]   ✓ CTV3RCTMAP - 445473 rows
[2025-12-28 15:17:32] [PASS]   ✓ CTV3SCTMAP - 445473 rows
[2025-12-28 15:17:32] [PASS]   ✓ ICD - 19267 rows
[2025-12-28 15:17:32] [PASS]   ✓ ICDHIER - 19267 rows
[2025-12-28 15:17:32] [PASS]   ✓ ICDSCTMAP - 37729 rows
[2025-12-28 15:17:32] [PASS]   ✓ ICDTC - 77965 rows
[2025-12-28 15:17:32] [PASS]   ✓ MAPVERSIONS - 10 rows
[2025-12-28 15:17:32] [PASS]   ✓ OPCS - 11686 rows
[2025-12-28 15:17:32] [PASS]   ✓ OPCSHIER - 11686 rows
[2025-12-28 15:17:32] [PASS]   ✓ OPCSSCTMAP - 20816 rows
[2025-12-28 15:17:32] [PASS]   ✓ OPCSTC - 44789 rows
[2025-12-28 15:17:32] [PASS]   ✓ RCTCTV3MAP - 102066 rows
[2025-12-28 15:17:32] [PASS]   ✓ RCTSCTMAP - 102057 rows
[2025-12-28 15:17:32] [PASS]   ✓ SCTICDMAP - 117992 rows
[2025-12-28 15:17:32] [PASS]   ✓ SCTOPCSMAP - 71730 rows
[2025-12-28 15:17:32] [INFO] Testing: DMWB NHS Public Code Usage.mdb
[2025-12-28 15:17:33] [PASS]   ✓ SCTFREQ - 1133250 rows
[2025-12-28 15:17:33] [INFO] Testing: DMWB NHS READ.mdb
[2025-12-28 15:17:33] [PASS]   ✓ CTV3 - 395650 rows
[2025-12-28 15:17:33] [PASS]   ✓ ctv3_rmf - 55272 rows
[2025-12-28 15:17:33] [PASS]   ✓ ctv3_term - 351470 rows
[2025-12-28 15:17:33] [PASS]   ✓ CTV3EQV - 803372 rows
[2025-12-28 15:17:33] [PASS]   ✓ CTV3HIER - 287969 rows
[2025-12-28 15:17:34] [PASS]   ✓ CTV3TC - 2241382 rows
[2025-12-28 15:17:34] [PASS]   ✓ RCT - 175017 rows
[2025-12-28 15:17:34] [PASS]   ✓ RCTEQV - 336712 rows
[2025-12-28 15:17:34] [PASS]   ✓ RCTHIER - 157280 rows
[2025-12-28 15:17:34] [PASS]   ✓ RCTTC - 664554 rows
[2025-12-28 15:17:34] [INFO] Testing: DMWB NHS SNOMED History.mdb
[2025-12-28 15:17:34] [PASS]   ✓ SCTCHIST - 0 rows
[2025-12-28 15:17:34] [PASS]   ✓ SCTEQV - 112217 rows
[2025-12-28 15:17:34] [PASS]   ✓ SCTHIST - 352610 rows
[2025-12-28 15:17:34] [PASS]   ✓ SCTHREL - 348238 rows
[2025-12-28 15:17:35] [PASS]   ✓ SCTMETA - 1141797 rows
[2025-12-28 15:17:35] [PASS]   ✓ SCTSUBST - 0 rows
[2025-12-28 15:17:35] [PASS]   ✓ SUBSETLIST - 1507 rows
[2025-12-28 15:17:35] [PASS]   ✓ SUBSETS - 461419 rows
[2025-12-28 15:17:35] [PASS]   ✓ SUBSETS_RD - 2652514 rows
[2025-12-28 15:17:35] [INFO] Testing: DMWB NHS SNOMED Lexicon.mdb
[2025-12-28 15:17:36] [PASS]   ✓ TOKENINDEX - 12951424 rows
[2025-12-28 15:17:36] [PASS]   ✓ TOKENS - 127220 rows
[2025-12-28 15:17:36] [PASS]   ✓ WEQ - 25349 rows
[2025-12-28 15:17:36] [INFO] Testing: DMWB NHS SNOMED Query Table.mdb
[2025-12-28 15:17:39] [PASS]   ✓ SCTQT - 22918684 rows
[2025-12-28 15:17:39] [INFO] Testing: DMWB NHS SNOMED Transitive Closure.mdb
[2025-12-28 15:17:40] [PASS]   ✓ SCTTC - 11637305 rows
[2025-12-28 15:17:40] [INFO] Testing: DMWB NHS SNOMED.mdb
[2025-12-28 15:17:41] [PASS]   ✓ SCT - 3337614 rows
[2025-12-28 15:17:41] [PASS]   ✓ SCTHIER - 1476926 rows
[2025-12-28 15:17:41] [PASS]   ✓ SCTMODREL - 137 rows
[2025-12-28 15:17:41] [PASS]   ✓ SCTMRCM - 277 rows
[2025-12-28 15:17:42] [PASS]   ✓ SCTREL - 3430701 rows
[2025-12-28 15:17:42] [PASS]   ✓ VERSIONS - 6 rows
[2025-12-28 15:17:42] [INFO] Testing: NHS Data Migration Workbench GUI.mdb
[2025-12-28 15:17:42] [INFO] 
Testing specific known mappings...
[2025-12-28 15:17:42] [FAIL]   ❌ G802. mismatch: expected 84114007, got 266267005
[2025-12-28 15:17:42] [PASS]   ✓ C10.. → 73211009
[2025-12-28 15:17:42] [FAIL]   ❌ G30.. mismatch: expected 22298006, got 57054005
[2025-12-28 15:17:42] [INFO] 
Testing hierarchical relationships...
[2025-12-28 15:17:42] [PASS]   ✓ Diabetes has 16 children
[2025-12-28 15:17:42] [INFO] 
[2025-12-28 15:17:42] [INFO] ========================================================
[2025-12-28 15:17:42] [INFO] TEST SUMMARY
[2025-12-28 15:17:42] [INFO] ========================================================
[2025-12-28 15:17:42] [PASS] Passed:   49
[2025-12-28 15:17:42] [FAIL] Failed:   2
[2025-12-28 15:17:42] [INFO] Warnings: 0
[2025-12-28 15:17:42] [INFO] Total:    51
[2025-12-28 15:17:43] [INFO] 
[2025-12-28 15:17:43] [INFO] HTML Report: O:\GitHub\snomed-database-loader\DMWB\Test-DMWBExport_20251228_151731.html
[2025-12-28 15:17:43] [INFO] Log File: O:\GitHub\snomed-database-loader\DMWB\Test-DMWBExport_20251228_151731.log
[2025-12-28 15:17:43] [INFO] 
[2025-12-28 15:17:43] [FAIL] ❌ 2 test(s) failed
